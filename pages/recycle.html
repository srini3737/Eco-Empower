<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recycle & Earn - Eco Empower</title>
    <link rel="icon" type="../images/x-icon" href="../img/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/navbar&footer.css">
    <link rel="stylesheet" href="../css/style1.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../js/config.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/wallet.js"></script>
</head>

<body>
    <section id="backgroundimage" style="height: 200px;">
        <!-- nav -->
        <section>
            <nav class="navbar navbar-dark navbar-expand-lg fixed-top" id="index-navbarFont">
                <div class="container-fluid">
                    <a class="navbar-brand" href="../index.html"><img id="j-navbarBrand" src="../img/navbarbrand.png"
                            alt="Brand Logo"></a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#j-navBar">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="j-navBar">
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item">
                                <a href="#" class="nav-link text-warning fw-bold" id="wallet-nav-link">ðŸ’° Eco Wallet</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="../index.html">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="item.html">Items</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="advice.html">Advice</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="frugality.html">Frugality</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="recycle.html">Recycle</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="aboutus.html">About Us</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="faq.html">FAQ</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </section>
    </section>

    <div class="container mt-5 mb-5">
        <h2 class="text-center mb-4" style="color: #435334; font-weight: bold;">Sell Your Recyclable Waste</h2>
        <p class="text-center mb-5">Select waste type, enter weight, and earn money immediately in your Eco Wallet!</p>

        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card shadow-sm p-4" style="background-color: #f8fbfa; border-radius: 20px;">
                    <form id="recycleForm">
                        <div class="mb-3">
                            <label for="wasteType" class="form-label fw-bold">Waste Type</label>
                            <select class="form-select" id="wasteType" required>
                                <option value="" selected disabled>Choose waste type...</option>
                                <option value="10">Plastic (â‚¹10/kg)</option>
                                <option value="20">Iron (â‚¹20/kg)</option>
                                <option value="5">Paper (â‚¹5/kg)</option>
                                <option value="2">Glass (â‚¹2/kg)</option>
                                <option value="50">E-waste (â‚¹50/kg)</option>
                                <option value="6">Cardboard (â‚¹6/kg)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="weight" class="form-label fw-bold">Weight (kg)</label>
                            <input type="number" class="form-control" id="weight" min="0.1" step="0.1"
                                placeholder="Enter weight in kg" required>
                        </div>
                        <div class="mb-4">
                            <h4 class="text-end" style="color: #435334;">Estimated Earning: <span
                                    id="estimatedVal">â‚¹0</span></h4>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-success btn-lg" style="border-radius: 12px;">Sell &
                                Earn</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal fade" id="earnSuccessModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4">
                <div class="modal-body d-flex flex-column align-items-center justify-content-center">
                    <i class="fas fa-check-circle fa-4x text-success mb-3"></i>
                    <h3 class="mb-3">Congratulations!</h3>
                    <p class="lead">You have successfully sold your waste.</p>
                    <div class="mt-3 mb-2">
                        <h2 class="text-success fw-bold d-block" id="earnedAmountDisplay">â‚¹0</h2>
                    </div>
                    <p>has been added to your Eco Wallet.</p>
                    <button type="button" class="btn btn-success mt-3" data-bs-dismiss="modal">Awesome!</button>
                </div>
            </div>
        </div>
    </div>

    <!-- footer start-->
    <section id="sec55">
        <div class="container text-center Mcontactus">
            <h4 class="Mh4">Contact Us</h4>
            <span class="emailandgmail">Email:ecoempower@gmail.com</span>
            <br>
            <span class="emailandgmail">Phone:+91 8919561672</span>
            <p class="mt-3 text-center">
                Feel free to drop us a message or give us a call. Whether you're curious about our products, need help
                with an order, or want to share your thoughts, we're all ears. Your satisfaction is our top priority,
                and we're committed to addressing your needs promptly.
            </p>
        </div>

        <footer class="bg-light pb-4">
            <div class="container">
                <div class="row">
                    <div class="col-md-4 text-center mt-3">
                        <h3>Feedback</h3>
                        <p>We value your feedback. Please let us know how we can improve.</p>
                        <form>
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" id="feedback-input"
                                    placeholder="Enter your feedback" aria-label="Enter your feedback"
                                    aria-describedby="submit-button">
                                <button class="btn btn-success" type="button" id="submit-button" data-bs-toggle="modal"
                                    data-bs-target="#feedback-modal" disabled
                                    onclick="clearInputField()">Submit</button>
                            </div>
                        </form>
                    </div>

                    <div class="col-md-4 text-center mt-3">
                        <h3>About Us</h3>
                        <a href="../pages/aboutus.html" class="footerTexttoDark">
                            <p class="text-center">Get to know us better by exploring our website</p>
                        </a>
                    </div>

                    <div class="col-md-4 text-center mt-3">
                        <h3>FAQ</h3>
                        <a href="../pages/faq.html" class="footerTexttoDark">
                            <p class="text-center">Discover solutions to frequently asked questions</p>
                        </a>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="feedback-modal">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="modalLabel4">Thanks for your Feedback!!</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p>Have a nice day!</p><i class="fa-solid fa-heart ms-1 font-awesome-icon-in-footer"></i>
                        </div>
                    </div>
                </div>
            </div>


            <hr class="my-4">
            <div class="text-center">
                <i>Thank you for considering us. We can't wait to hear from you and assist you in any way we can!</i>

                <hr>
                <a href="https://www.facebook.com/"><i class="fa-brands fa-facebook fa-2x footericon-color"></i></a>
                <a href="https://www.instagram.com/accounts/login/"><i
                        class="fa-brands fa-instagram fa-2x mx-5 footericon-color"></i></a>
                <a href="https://discord.com/login"><i class="fa-brands fa-discord fa-2x footericon-color"></i></a>
            </div>
        </footer>

        <!-- copyright -->
        <div class="text-success d-flex justify-content-center my-4">
            Copyright &copy; 2026 Eco Empower | Designed by Aragonda Srinivas
        </div>

    </section>

    <script>
        $(document).ready(function () {
            // Calculate estimated value on input change
            function calculateTotal() {
                var rate = $('#wasteType').val();
                var weight = $('#weight').val();
                if (rate && weight) {
                    var total = parseFloat(rate) * parseFloat(weight);
                    $('#estimatedVal').text("â‚¹" + total.toFixed(2));
                } else {
                    $('#estimatedVal').text("â‚¹0");
                }
            }

            $('#wasteType, #weight').on('change keyup', calculateTotal);

            // Handle Sell button
            $('#recycleForm').submit(function (e) {
                e.preventDefault();
                var rate = $('#wasteType').val();
                var weight = $('#weight').val();

                // Check auth
                if (!authSystem.getCurrentUser()) {
                    alert("Please login to recycle and earn.");
                    window.location.href = "login.html";
                    return;
                }

                if (rate && weight) {
                    var total = parseFloat(rate) * parseFloat(weight);

                    // Add to wallet (Async now)
                    $.ajax({
                        url: config.API_URL + '/wallet/add',
                        method: 'POST',
                        contentType: 'application/json',
                        headers: config.getHeaders(),
                        data: JSON.stringify({ amount: total }),
                        success: function (response) {
                            if (response.success) {
                                // Reload wallet to update UI
                                ecoWallet.reload();

                                // Show success modal
                                $('#earnedAmountDisplay').text("â‚¹" + total.toFixed(2));
                                $('#earnSuccessModal').modal('show');

                                // Reset form
                                $('#recycleForm')[0].reset();
                                $('#estimatedVal').text("â‚¹0");
                            } else {
                                alert("Failed to add funds: " + response.message);
                            }
                        },
                        error: function () {
                            alert("Error processing transaction. Please try again.");
                        }
                    });
                }
            });
        });
    </script>
</body>

</html>